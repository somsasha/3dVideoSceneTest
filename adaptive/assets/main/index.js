System.register("chunks:///_virtual/Debug.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ThingsCreator.ts"],(function(e){"use strict";var t,i,n,o,s,r,a,l,c,u,h,p,f,g;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){s=e.cclegacy,r=e._decorator,a=e.Node,l=e.EditBox,c=e.input,u=e.Input,h=e.Vec3,p=e.KeyCode,f=e.Component},function(e){g=e.ThingsCreator}],execute:function(){var b,v,w,d,y,D,m,C,A,E,k,B,P;s._RF.push({},"51353pprxZO25I3WU0aqaN+","Debug",void 0);var x=r.ccclass,z=r.property;e("Debug",(b=x("Debug"),v=z(a),w=z(g),d=z(a),y=z(a),D=z([l]),b((A=t((C=function(e){function t(){for(var t,i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];return t=e.call.apply(e,[this].concat(s))||this,n(t,"content",A,o(t)),n(t,"creator",E,o(t)),n(t,"walls",k,o(t)),n(t,"wallsDebug",B,o(t)),n(t,"wallsEditBoxes",P,o(t)),t.isActive=!1,t}i(t,e);var s=t.prototype;return s.onLoad=function(){c.on(u.EventType.KEY_DOWN,this.onKeyDown,this)},s.regenerate=function(){for(var e=this.content.children,t=0;t<e.length;t++){var i=e[t].name,n=e[t].getComponentInChildren(l);if(n){var o=+n.string;o||(o=0),this.creator.setThingCount(i,o)}}this.setActive(!1),this.creator.reset()},s.setShowWalls=function(e){"Left"===e.node.name?this.wallsDebug[0].active=e.isChecked:"Right"===e.node.name?this.wallsDebug[1].active=e.isChecked:"Front"===e.node.name?this.wallsDebug[2].active=e.isChecked:"Back"===e.node.name&&(this.wallsDebug[3].active=e.isChecked)},s.moveWalls=function(){for(var e=0;e<this.wallsEditBoxes.length;e++){var t=this.wallsEditBoxes[e],i=t.node.name,n=t.string.split(","),o=+(n[0]||0),s=+(n[1]||0),r=+(n[2]||0),a=new h(o,s,r);"Left"===i?this.walls[0].setPosition(a):"Right"===i?this.walls[1].setPosition(a):"Front"===i?this.walls[2].setPosition(a):"Back"===i&&this.walls[3].setPosition(a)}},s.setActive=function(e){this.isActive=e,this.node.setPosition(this.isActive?0:5e3,this.isActive?0:5e3,0)},s.onKeyDown=function(e){switch(e.keyCode){case p.KEY_O:this.setActive(!this.isActive);break;case p.ESCAPE:this.setActive(!1)}},t}(f)).prototype,"content",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=t(C.prototype,"creator",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=t(C.prototype,"walls",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),B=t(C.prototype,"wallsDebug",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),P=t(C.prototype,"wallsEditBoxes",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),m=C))||m));s._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./Debug.ts","./PlateController.ts","./PlatePlace.ts","./Thing.ts","./ThingsController.ts","./ThingsCreator.ts"],(function(){"use strict";return{setters:[null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/PlateController.ts",["./rollupPluginModLoBabelHelpers.js","cc","./PlatePlace.ts"],(function(t){"use strict";var e,n,o,i,r,s,a,l,c,h,u,p,d,f;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,o=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.input,l=t.Input,c=t.Tween,h=t.Quat,u=t.easing,p=t.KeyCode,d=t.Component},function(t){f=t.PlatePlace}],execute:function(){var g,v,P,y,w;r._RF.push({},"ca84eoc08hDmI050deOT0eH","PlateController",void 0);var T=s.ccclass,b=s.property;t("PlateController",(g=T("PlateController"),v=b(f),g((w=e((y=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,o(e,"places",w,i(e)),e}n(e,t);var r=e.prototype;return r.onLoad=function(){a.on(l.EventType.KEY_DOWN,this.onKeyDown,this)},r.getPlace=function(t){for(var e=[],n=0;n<this.places.length;n++)this.places[n].currentThing&&this.places[n].currentThing.node===t&&e.push(this.places[n]);for(var o=t.getWorldPosition().x,i=null,r=1/0,s=0;s<e.length;s++){var a=Math.abs(e[s].node.getWorldPosition().x-o);a<r&&(r=a,i=e[s])}return i||null},r.setThing=function(t,e){var n=this;t.isActive=!1;var o=t.node.getWorldPosition().add(e.platePositionOffset);new c(e.node).to(.25,{worldPosition:o,scale:e.plateScale,rotation:h.fromEuler(new h,e.plateRotation.x,e.plateRotation.y,e.plateRotation.z)}).call((function(){n.check()})).start()},r.check=function(){for(var t={},e=0;e<this.places.length;e++)if(!this.places[e].isActive){var n=this.places[e].currentThing.id;t[n]?t[n]+=1:t[n]=1}for(var o in t)t[o]>=3&&this.mergeId(+o)},r.mergeId=function(t){for(var e=[],n=0;n<this.places.length&&(this.places[n].isActive||(this.places[n].currentThing.id===t&&(e.push(this.places[n].currentThing),this.places[n].clear()),3!==e.length));n++);e.sort((function(t,e){return Math.abs(t.node.position.x-e.node.position.x)}));var o=e[1].node.getWorldPosition();new c(e[0].node).to(.25,{worldPosition:o},{easing:u.cubicInOut}).start(),new c(e[2].node).to(.25,{worldPosition:o},{easing:u.cubicInOut}).start(),this.scheduleOnce((function(){for(var t=0;t<e.length;t++)e[t].node.destroy()}),.4)},r.clearAll=function(){for(var t=0;t<this.places.length;t++)!this.places[t].isActive&&this.places[t].currentThing&&this.places[t].currentThing.node.destroy(),this.places[t].clear()},r.onKeyDown=function(t){switch(t.keyCode){case p.KEY_P:this.clearAll()}},e}(d)).prototype,"places",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),P=y))||P));r._RF.pop()}}}));

System.register("chunks:///_virtual/PlatePlace.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Thing.ts"],(function(t){"use strict";var e,i,n,r,o,c,l,s,a,u;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){o=t.cclegacy,c=t._decorator,l=t.CCInteger,s=t.Collider,a=t.Component},function(t){u=t.Thing}],execute:function(){var g,h,p,f,v;o._RF.push({},"83312HkmaFHSKsBJ8jKfXF2","PlatePlace",void 0);var T=c.ccclass,d=c.property;t("PlatePlace",(g=T("PlatePlace"),h=d(l),g((v=e((f=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),c=0;c<i;c++)o[c]=arguments[c];return e=t.call.apply(t,[this].concat(o))||this,n(e,"placeId",v,r(e)),e.isActive=!0,e.currentThing=null,e}i(e,t);var o=e.prototype;return o.start=function(){var t=this.node.getComponent(s);t.on("onTriggerEnter",this.onTriggerEnter,this),t.on("onTriggerExit",this.onTriggerExit,this)},o.clear=function(){this.currentThing=null,this.isActive=!0},o.onTriggerEnter=function(t){if(this.isActive){var e=t.otherCollider.node.getComponent(u);e&&(this.currentThing=e)}},o.onTriggerExit=function(t){this.isActive&&(this.currentThing=null)},e}(a)).prototype,"placeId",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),p=f))||p));o._RF.pop()}}}));

System.register("chunks:///_virtual/Thing.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){"use strict";var t,i,n,r,o,a,l,c,u;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){o=e.cclegacy,a=e._decorator,l=e.CCInteger,c=e.Vec3,u=e.Component}],execute:function(){var p,s,f,b,g,h,y,w,d,m,v;o._RF.push({},"4abecENNUlAj4Vl3Y6Z3gwE","Thing",void 0);var z=a.ccclass,T=a.property;e("Thing",(p=z("Thing"),s=T(l),f=T(c),b=T(c),g=T(c),p((w=t((y=function(e){function t(){for(var t,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,n(t,"id",w,r(t)),n(t,"platePositionOffset",d,r(t)),n(t,"plateScale",m,r(t)),n(t,"plateRotation",v,r(t)),t}return i(t,e),t}(u)).prototype,"id",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),d=t(y.prototype,"platePositionOffset",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new c(0,0,0)}}),m=t(y.prototype,"plateScale",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new c(1,1,1)}}),v=t(y.prototype,"plateRotation",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new c(0,0,0)}}),h=y))||h));o._RF.pop()}}}));

System.register("chunks:///_virtual/ThingsController.ts",["./rollupPluginModLoBabelHelpers.js","cc","./PlateController.ts","./Thing.ts"],(function(t){"use strict";var i,n,e,o,r,a,c,l,s,u,h,T,p,g,v,w,f,d,m;return{setters:[function(t){i=t.applyDecoratedDescriptor,n=t.inheritsLoose,e=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,a=t._decorator,c=t.Camera,l=t.CCFloat,s=t.Node,u=t.input,h=t.Input,T=t.geometry,p=t.PhysicsSystem,g=t.MobilityMode,v=t.RigidBody,w=t.Vec3,f=t.Component},function(t){d=t.PlateController},function(t){m=t.Thing}],execute:function(){var y,A,b,P,C,S,D,z,R,E,L,_,k,M,F,H,O,B,U;r._RF.push({},"3e61e+Pbe5NAJ3VdGkddPmh","ThingsController",void 0);var x=a.ccclass,N=a.property;t("ThingsController",(y=x("ThingsController"),A=N(c),b=N(l),P=N(s),C=N(s),S=N(s),D=N(s),z=N(l),R=N(d),y((_=i((L=function(t){function i(){for(var i,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return i=t.call.apply(t,[this].concat(r))||this,e(i,"camera",_,o(i)),e(i,"tapDuration",k,o(i)),e(i,"wallLeft",M,o(i)),e(i,"wallRight",F,o(i)),e(i,"wallFront",H,o(i)),e(i,"wallBack",O,o(i)),e(i,"wallsTreashold",B,o(i)),e(i,"plate",U,o(i)),i.currentActiveThing=null,i.currentActiveThingDistance=0,i.currentActiveThingStartPosition=new w,i.currentActiveThingTapPositionDelta=new w,i.currantActiveThingTapTime=0,i}n(i,t);var r=i.prototype;return r.onLoad=function(){var t=this;window.destructionAnimation={maxScale:1.1,increaseTime:.15,minScale:0,decreaseTime:.15},u.on(h.EventType.TOUCH_START,this.onTouchStart,this),u.on(h.EventType.TOUCH_END,this.onTouchEnd,this),u.on(h.EventType.TOUCH_MOVE,this.onTouchMove,this),window.setSize=function(i,n,e,o){void 0===e&&(e=0),void 0===o&&(o=0),t.wallLeft.setPosition(i/2+e,t.wallLeft.position.y,t.wallLeft.position.z),t.wallLeft.setPosition(-i/2+e,t.wallRight.position.y,t.wallRight.position.z),t.wallFront.setPosition(t.wallFront.position.x,t.wallFront.position.y,n/2-o),t.wallBack.setPosition(t.wallBack.position.x,t.wallBack.position.y,-n/2-o)},window.setDestructionAnimation=function(t,i,n,e){window.destructionAnimation.maxScale=t,window.destructionAnimation.increaseTime=i,window.destructionAnimation.minScale=n,window.destructionAnimation.decreaseTime=e}},r.onDestroy=function(){u.off(h.EventType.TOUCH_START,this.onTouchStart,this),u.off(h.EventType.TOUCH_END,this.onTouchEnd,this),u.off(h.EventType.TOUCH_MOVE,this.onTouchMove,this)},r.onTouchStart=function(t){var i=new T.Ray;this.camera.screenPointToRay(t.getLocationX(),t.getLocationY(),i);if(p.instance.raycast(i,4294967295,1e7,!0)){var n=p.instance.raycastResults,e=null;n.sort((function(t,i){return t.distance-i.distance}));for(var o=0;o<n.length;o++){var r,a;if(null!=(r=n[o])&&null!=(a=r.collider)&&a.node&&n[o].collider.node.mobility===g.Movable){e=n[o];break}}if(!e)return;var c=e.collider.node;this.currentActiveThing=c,this.currentActiveThingDistance=e.distance,this.currentActiveThingStartPosition=this.currentActiveThing.getWorldPosition(),this.currentActiveThingTapPositionDelta=this.currentActiveThingStartPosition.clone().subtract(e.hitPoint),this.currentActiveThing.getComponent(v).isKinematic=!0,this.currentActiveThing.getComponent(v).allowSleep=!1,this.currentActiveThing.getComponent(v).wakeUp(),this.currantActiveThingTapTime=Date.now()}},r.onTouchMove=function(t){if(this.currentActiveThing){var i=new T.Ray;this.camera.screenPointToRay(t.getLocationX(),t.getLocationY(),i);var n=new w;i.computeHit(n,this.currentActiveThingDistance),n=n.add(this.currentActiveThingTapPositionDelta),this.currentActiveThing.setWorldPosition(n.x,this.currentActiveThingStartPosition.y,n.z)}},r.onTouchEnd=function(){if(this.currentActiveThing){var t=this.plate.getPlace(this.currentActiveThing);t?(this.currentActiveThing.mobility=g.Static,this.plate.setThing(t,this.currentActiveThing.getComponent(m))):this.currentActiveThing.getComponent(v).isKinematic=!1,this.currentActiveThing.getComponent(v).allowSleep=!0}this.currentActiveThing=null},i}(f)).prototype,"camera",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=i(L.prototype,"tapDuration",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),M=i(L.prototype,"wallLeft",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=i(L.prototype,"wallRight",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=i(L.prototype,"wallFront",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=i(L.prototype,"wallBack",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=i(L.prototype,"wallsTreashold",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),U=i(L.prototype,"plate",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=L))||E));r._RF.pop()}}}));

System.register("chunks:///_virtual/ThingsCreator.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Thing.ts"],(function(t){"use strict";var n,e,i,r,a,o,s,u,l,c,p,h,f,g,b;return{setters:[function(t){n=t.applyDecoratedDescriptor,e=t.initializerDefineProperty,i=t.inheritsLoose,r=t.assertThisInitialized},function(t){a=t.cclegacy,o=t._decorator,s=t.Prefab,u=t.CCInteger,l=t.Vec3,c=t.Node,p=t.CCFloat,h=t.instantiate,f=t.RigidBody,g=t.Component},function(t){b=t.Thing}],execute:function(){var d,w,m,T,y,v,D,C,P,R,z,S,I,O,M,F,_,L,j,x,B,k,A,E,H,N;a._RF.push({},"12184tZ3C5MjIeU9OsExf59","ThingsCreator",void 0);var U=o.ccclass,V=o.property,Z=t("ThingData",(d=U("ThingData"),w=V(s),m=V(u),T=V(l),y=V(l),v=V(l),d((P=n((C=function(){e(this,"prefab",P,this),e(this,"count",R,this),e(this,"platePositionOffset",z,this),e(this,"plateScale",S,this),e(this,"plateRotation",I,this),this.id=0}).prototype,"prefab",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=n(C.prototype,"count",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),z=n(C.prototype,"platePositionOffset",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new l(0,0,0)}}),S=n(C.prototype,"plateScale",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new l(1,1,1)}}),I=n(C.prototype,"plateRotation",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new l(0,0,0)}}),D=C))||D));t("ThingsCreator",(O=U("ThingsCreator"),M=V(Z),F=V(c),_=V(p),L=V(p),j=V(p),O((k=n((B=function(t){function n(){for(var n,i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a))||this,e(n,"things",k,r(n)),e(n,"spawnPoint",A,r(n)),e(n,"spawnRadius",E,r(n)),e(n,"spawnDelay",H,r(n)),e(n,"spawnImpuls",N,r(n)),n.currentThingsData=[],n.currentThings=[],n}i(n,t);var a=n.prototype;return a.onLoad=function(){for(var t=this,n=0;n<this.things.length;n++)this.things[n].id=n;this.createScene(),window.resetScene=function(){t.reset()},window.setCount=function(n,e){t.setThingCount(n,e)}},a.reset=function(){for(var t=0;t<this.currentThings.length;t++)this.currentThings[t]&&this.currentThings[t].destroy();this.currentThings=[],this.createScene()},a.setThingCount=function(t,n){for(var e=0;e<this.things.length;e++)if(this.things[e].prefab.name===t)return void(this.things[e].count=n);console.warn("Invalid prefab name")},a.createScene=function(){for(var t=this,n=0;n<this.things.length;n++){var e=this.things[n];if(!(e.count<=0)){var i=new Z;i.prefab=e.prefab,i.count=e.count,i.platePositionOffset=e.platePositionOffset,i.plateScale=e.plateScale,i.plateRotation=e.plateRotation,i.id=e.id,this.currentThingsData.push(i)}}for(var r=0,a=function(){var n=t.randomInt(0,t.currentThingsData.length-1),e=t.currentThingsData[n],i=t.spawnPoint.getPosition().clone();i.add3f(t.randomFloat(0,t.spawnRadius/2),0,t.randomFloat(0,t.spawnRadius/2)),t.scheduleOnce((function(){t.spawn(e,i)}),t.spawnDelay*r),r+=1,t.currentThingsData[n].count-=1,t.currentThingsData[n].count<=0&&t.currentThingsData.splice(n,1)};this.currentThingsData.length>0;)a()},a.spawn=function(t,n){var e=h(t.prefab),i=e.addComponent(b);i.platePositionOffset=t.platePositionOffset,i.plateScale=t.plateScale,i.plateRotation=t.plateRotation,i.id=t.id,e.setParent(this.node),e.setPosition(n),e.getComponent(f).applyImpulse(new l(0,this.spawnImpuls,0)),this.currentThings.push(e)},a.randomInt=function(t,n){return t=Math.ceil(t),n=Math.floor(n),Math.floor(Math.random()*(n-t+1))+t},a.randomFloat=function(t,n){return Math.random()*(n-t)+t},n}(g)).prototype,"things",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),A=n(B.prototype,"spawnPoint",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=n(B.prototype,"spawnRadius",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),H=n(B.prototype,"spawnDelay",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),N=n(B.prototype,"spawnImpuls",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-25}}),x=B))||x));a._RF.pop()}}}));
